async function getDatas(){let e=await fetch("./db.json");let{products:t}=await e.json();return t=t.map(e=>{var{id:t}=e.sys,{title:a,price:i}=e.content,{nowprice:s,oldprice:i}=i,{image:e}=e.images;return{id:t,title:a,oldprice:i,nowprice:s,image:e}}),t}function storageSaveProducts(e){localStorage.setItem("products",JSON.stringify(e))}function storageGetProducts(){return JSON.parse(localStorage.getItem("products"))}function storageSaveCart(e){localStorage.setItem("cart",JSON.stringify(e))}function storageGetCart(){return localStorage.getItem("cart")?JSON.parse(localStorage.getItem("cart")):[]}const addMiniCart=()=>{let a=[];for(const i of[...document.querySelectorAll("#add-cart")])i.onclick=()=>{var e=i.dataset.id,t=storageGetCart(),e={...findProduct(e),amount:1};a=[...t,e];for(let t=0;t<a.length;t++)for(let e=t+1;e<a.length;e++)a[t].id===a[e].id&&(a.splice(e,1),a[t].amount+=1);e=[...a];storageSaveCart(e),renderMiniCart(e),setMiniCartValue(e)}},removeMiniCart=a=>{for(const i of[...document.querySelectorAll(".remove-product")])i.onclick=()=>{let t=i.dataset.id;var e=a.filter(e=>e.id!==t);renderMiniCart(e),setMiniCartValue(e),storageSaveCart(e)}},findProduct=t=>{let e=[...storageGetProducts()];return e.find(e=>e.id===t)},renderMiniCart=e=>{let t=document.querySelector(".cart__dropdown");if(t.innerHTML="",0===e.length){let e=document.createElement("h4");e.setAttribute("class","cart__dropdown-message");return e.innerText="Your cart is currently empty",void t.appendChild(e)}let a=e.map(e=>`
    <div class="cart__dropdown-inner">
        <div class="single-product__img"><img src="${e.image}" alt=""></div>
        <div class="single-product__text">
            <a class="single-product__text-name" href="#">${e.title}</a>
            <span class="single-product__text-quantiny">${e.amount}</span>
            <h4 class="single-product__text-price">$${e.nowprice}</h4>
        </div><span class="fas fa-trash-alt remove-product" data-id="${e.id}"></span>
    </div>`);var i=a.join("").concat(`
  <div class="cart__dropdown-total"> 
    <span>Total</span>
    <span class="cart-total">$0.00</span>
  </div>
  <div class="cart__dropdown-btn"> 
        <a class="view-cart" href="cart.html">view cart</a>
        <a class="check-cart" href="#">check cart</a>
  </div>
`);t.innerHTML=i,setMiniCartValue(e),removeMiniCart(e)},setMiniCartValue=e=>{let t=[...e],a=document.querySelector(".cart-count"),i=document.querySelectorAll(".cart-total"),s=0,n=0;if(0===e.length)return a.innerHTML=s,void i.forEach(e=>{e.innerHTML=`$${n.toFixed(2)}`});t.forEach(e=>{s+=+e.amount,n+=e.amount*e.nowprice}),a.innerHTML=s,i.forEach(e=>{e.innerHTML=`$${n.toFixed(2)}`})},defaultLoadingMiniCart=()=>{var e=storageGetCart();renderMiniCart(e),e.length};defaultLoadingMiniCart();const main={init:function(){this.navMenu(),this.bannerSlide(),this.carousel(),this.load()},navMenu:function(){const e=document.querySelector(".head-mobile"),t=document.querySelector(".head-nav"),a=document.querySelector(".head"),i=document.querySelectorAll(".nav-plus");let s=a.offsetHeight,n=!0;function r(){window.pageYOffset>s?a.classList.add("head--active"):a.classList.remove("head--active")}e.addEventListener("click",function(){t.classList.toggle("head-nav--active")}),window.addEventListener("scroll",r),i.forEach(i=>{i.addEventListener("click",e=>{e.preventDefault(),n=!n;let t=i.childNodes[0],a=i.parentElement.nextElementSibling;a.classList.toggle("sub-menu--active"),n?t.className="fas fa-plus":t.className="fas fa-minus"})}),r()},bannerSlide:function(){if(document.querySelector(".banner")){const s=[...document.querySelectorAll(".banner-slides__item")],n=[...document.querySelectorAll(".banner-slides__dot")];!function(){let i=setInterval(()=>{let e=0,t=document.querySelector(".banner-slides__item--active");for(e;t=t.previousElementSibling;e++);a(e)},3e3);function a(e){if(e<s.length-1){for(let e=0;e<s.length;e++)s[e].classList.remove("banner-slides__item--active"),n[e].classList.remove("banner-slides__dot--active");s[e].nextElementSibling.classList.add("banner-slides__item--active"),n[e].nextElementSibling.classList.add("banner-slides__dot--active")}else{for(let e=0;e<s.length;e++)s[e].classList.remove("banner-slides__item--active"),n[e].classList.remove("banner-slides__dot--active");s[0].classList.add("banner-slides__item--active"),n[0].classList.add("banner-slides__dot--active")}}n.forEach(a=>{a.addEventListener("click",()=>{clearInterval(i);let e=0;n.forEach(e=>{e.classList.remove("banner-slides__dot--active")}),a.classList.add("banner-slides__dot--active");let t=document.querySelector(".banner-slides__dot--active");for(e;t=t.previousElementSibling;e++);s.forEach(e=>{e.classList.remove("banner-slides__item--active")}),s[e].classList.add("banner-slides__item--active")})});let e=document.querySelector(".banner-slides__prev"),t=document.querySelector(".banner-slides__next");e.addEventListener("click",function(){let e=0,t=document.querySelector(".banner-slides__item--active");for(clearInterval(i),e;t=t.previousElementSibling;e++);a(e)}),t.addEventListener("click",function(){let e=0,t=document.querySelector(".banner-slides__item--active");for(clearInterval(i),e;t=t.previousElementSibling;e++);a(e)})}()}},carousel:function(){var e=document.querySelector(".home-detail"),t=document.querySelector(".brand"),a=document.querySelector(".blog");e?$(".home-detail__slide").owlCarousel({loop:!0,margin:20,dots:!1,nav:!0,responsive:{0:{items:1},600:{items:1},1e3:{items:1}}}):console.log("Not Section"),t?$(".brand-slide").owlCarousel({loop:!1,margin:20,dots:!1,nav:!1,responsive:{0:{items:2},600:{items:3},767:{items:4},1e3:{items:5}}}):console.log("Not Section"),a?$(".blog-slide").owlCarousel({loop:!1,margin:20,dots:!1,nav:!0,responsive:{0:{items:1},600:{items:1},767:{items:2},1e3:{items:2}}}):console.log("Not Section")},load:function(){let e=document.querySelector(".loading");window.addEventListener("load",()=>{setTimeout(()=>{e.classList.add("loading--off")},1500)})}};main.init();let start=0,_limitTab=12,end=_limitTab;const TabCarousel=()=>{$(".tab-slider").owlCarousel({loop:!1,margin:10,nav:!0,responsive:{0:{items:1},480:{items:2},600:{items:2},1e3:{items:4}}})},handleTabClick=e=>{const l=[...document.querySelectorAll(".tab-list__link")];l.forEach((n,r)=>{n.onclick=()=>{n.className.includes("active")||getDatas().then(e=>{let t=[...document.querySelectorAll(".tab-panel")];l.forEach(e=>{e.classList.remove("tab-list__link--active")}),n.classList.add("tab-list__link--active");let a=n.dataset.tab;console.log(a);let i=t.filter(e=>{if(t.forEach(e=>{e.classList.remove("tab-panel--active")}),e.getAttribute("id")===a)return e});i[0].classList.add("tab-panel--active");var s=r+1;start=(s-1)*_limitTab,end=s*_limitTab,console.log(start),console.log(end),renderTab(e)})}})},renderTab=e=>{let t=[...e],a=t.slice(start,end);console.log(a);let i=document.querySelector(".tab-panel--active");i.innerHTML="";let s=document.createElement("div");s.setAttribute("class","tab-slider owl-carousel");let n=0,r=[];a.forEach((a,e)=>{if(r.push(a),n++,2==n){let e=document.createElement("div");e.setAttribute("class","product-items");let t=r.map(e=>`
        <div class="card-product">
            <div class="card-product__img">
                <img src="${e.image}" alt="">
                <div class="card-product__icon">
                <div class="card-action">
                    <div class="button-add" id="add-cart" data-id="${e.id}">
                    <span class="flaticon-shopping-cart"></span>
                    </div>
                    <div class="button-heart">
                    <span class="flaticon-heart"></span>
                    </div>
                </div>
                <div class="button-view"> 
                    <span class="flaticon-search"></span>
                </div>
                </div>
            </div>
            <div class="card-product__content"> 
                <a class="card-product__content-title">${e.title}</a>
                <div class="card-product__content-price">
                <span class="now-price">$${e.nowprice}</span>
                <span class="regular-price">${e.oldprice}</span>
                </div>
            </div>
        </div>
      `);a=t.join("");e.innerHTML=a,n=0,r=[],s.appendChild(e)}}),i.appendChild(s),TabCarousel(),handleTabClick(),addMiniCart()},tabHomePage=()=>{getDatas().then(e=>{renderTab(e),handleTabClick(e),addMiniCart()})};tabHomePage();const listProductCarousel=()=>{$(".list-products__slide").owlCarousel({loop:!1,margin:10,nav:!1,dots:!1,responsive:{0:{items:1},600:{items:1},1e3:{items:1}}})},renderListProduct=e=>{let t=[...e];let a=[...document.querySelectorAll(".list-products__slide")];a.forEach(a=>{let e=t.splice(0,12),i=0,s=[];e.forEach(e=>{if(i+=1,s.push(e),3==i){let e=document.createElement("div");e.setAttribute("class","list-products__slide-items");let t=s.map(e=>`<div class="list-products__slide-items-item">
            <div class="item-img"> 
              <img src="${e.image}" alt="">
            </div>
            <div class="item-text">
            <a class="product-title" href="#">${e.title}</a>
            <div class="product-price">
              <span class="now-price">$${e.nowprice}</span>
              <span class="regular-price">${e.oldprice}</span></div>
            <button class="list-products__button" data-id=${e.id} id="add-cart" type="button">add to cart</button>
            </div>
          </div>
            `);e.innerHTML=t.join(""),a.appendChild(e),i=0,s=[]}})}),listProductCarousel(),addMiniCart()},listProduct=()=>{getDatas().then(e=>{renderListProduct(e)})};listProduct();